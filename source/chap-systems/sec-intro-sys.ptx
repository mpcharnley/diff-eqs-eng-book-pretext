<?xml version="1.0" encoding="UTF-8" ?>
<!-- Generated by Pandoc using pretext.lua -->



	<section xml:id="sec-introtosys">
		<title>Introduction to systems of ODEs</title>


		<subsection xml:id="systems">
			<title>Systems</title>

			<p>
				Often we do not have just one dependent variable and one equation. For instance, we may be looking at multiple populations that are changing over time, or watching how the amount of support for multiple candidates develops leading up to an election. And as we will see, we may end up with systems of several equations and several dependent variables even if we start with a single equation.
			</p>

			<p>
				If we have several dependent variables, suppose <m>y_1</m>, <m>y_2</m>, …, <m>y_n</m>, then we can have a differential equation involving all of them and their derivatives with respect to one independent variable <m>x</m>. For example, <m>y_1'' = f(y_1',y_2',y_1,y_2,x)</m>. Usually, when we have two dependent variables we have two equations such as <me>\begin{align*}
y_1'' &amp; = f_1(y_1',y_2',y_1,y_2,x) , \\
y_2'' &amp; = f_2(y_1',y_2',y_1,y_2,x) ,
\end{align*}</me> for some functions <m>f_1</m> and <m>f_2</m>. We call the above a <em></em>. More precisely, the above is a <em></em> of ODEs as second order derivatives appear. The system <me>\begin{align*}
x_1' &amp; = g_1(x_1,x_2,x_3,t) , \\
x_2' &amp; = g_2(x_1,x_2,x_3,t) , \\
x_3' &amp; = g_3(x_1,x_2,x_3,t) ,
\end{align*}</me> is a <em></em>, where <m>x_1,x_2,x_3</m> are the dependent variables, and <m>t</m> is the independent variable.
			</p>

			<p>
				The terminology for systems is essentially the same as for single equations. For the system above, a <em>solution</em> is a set of three functions <m>x_1(t)</m>, <m>x_2(t)</m>, <m>x_3(t)</m>, such that <me>\begin{align*}
x_1'(t) &amp;= g_1\bigl(x_1(t),x_2(t),x_3(t),t\bigr) , \\
x_2'(t) &amp;= g_2\bigl(x_1(t),x_2(t),x_3(t),t\bigr) , \\
x_3'(t) &amp;= g_3\bigl(x_1(t),x_2(t),x_3(t),t\bigr) .
\end{align*}</me>
			</p>

			<p>
				In order to verify that something is a solution, we plug the different components into the solution to see that all of the equations are satisfied; if any one of the equations is not satisfied, then this set of functions is not a solution. We usually also have an <em>initial condition</em>. Just like for single equations we specify <m>x_1</m>, <m>x_2</m>, and <m>x_3</m> for some fixed <m>t</m>. For example, <m>x_1(0) = a_1</m>, <m>x_2(0) = a_2</m>, <m>x_3(0) = a_3</m> for some constants <m>a_1</m>, <m>a_2</m>, and <m>a_3</m>. For the second order system we would also specify the first derivatives at that same initial time point. And if we find a solution with constants in it, where by solving for the constants we find a solution for any initial condition, we call this solution the <em>general solution</em>. Best to look at a simple example.
			</p>


<example>
<title> </title>
<statement>			<p>
				Sometimes a system is easy to solve by solving for one variable and then for the second variable. Take the first order system <me>\begin{align*}
y_1' &amp; = y_1 , \\
y_2' &amp; = y_1 - y_2 ,
\end{align*}</me> with <m>y_1</m>, <m>y_2</m> as the dependent variables and <m>x</m> as the independent variable. Consider initial conditions <m>y_1(0) = 1</m>, <m>y_2(0) = 2</m> and solve the initial value problem.
			</p>
</statement>

<solution>			<p>
				We note that <m>y_1 = C_1 e^x</m> is the general solution of the first equation, which we can get because this equation does not involve <m>y_2</m> at all and we can get a solution via our normal first order equation methods. We then plug this <m>y_1</m> into the second equation and get the equation <m>y_2' = C_1e^x - y_2</m>, which is a linear first order equation that is easily solved for <m>y_2</m>. By the method of integrating factor we get 
<me>
e^x y_2 = \frac{C_1}{2}e^{2x} + C_2 ,
</me>
 or <m>y_2 = \frac{C_1}{2}e^{x} + C_2e^{-x}</m>. The general solution to the system is, therefore, 
<me>
y_1 = C_1 e^x , \qquad
y_2 = \frac{C_1}{2}e^{x} + C_2e^{-x} .
</me>
 We solve for <m>C_1</m> and <m>C_2</m> given the initial conditions. We substitute <m>x=0</m> and find that <m>C_1=1</m> and <m>C_2=\nicefrac{3}{2}</m>. Thus the solution is <m>y_1 = e^x</m>, and <m>y_2 = (\nicefrac{1}{2}) e^x + (\nicefrac{3}{2}) e^{-x}</m>.
			</p>
</solution>
</example>
			<p>
				Generally, we will not be so lucky to be able to solve for each variable separately as in the example above, and we will have to solve for all variables at once. While we won’t generally be able to solve for one variable and then the next, we will try to salvage as much as possible from this technique. It will turn out that in a certain sense we will still (try to) solve a bunch of single equations and put their solutions together. Let’s not worry right now about how to solve systems yet.
			</p>

			<p>
				We will mostly consider <em></em>. The example above is an example of a <em></em>. It is linear as none of the dependent variables or their derivatives appear in nonlinear functions or with powers higher than one (<m>x</m>, <m>y</m>, <m>x'</m> and <m>y'</m>, constants, and functions of <m>t</m> can appear, but not <m>xy</m> or <m>{(y')}^2</m> or <m>x^3</m>). A more complicated example of a second order linear system is <me>\begin{align*}
y_1'' &amp;= e^t y_1' + t^2 y_1 + 5 y_2 + \sin(t), \\
y_2'' &amp;= t y_1'-y_2' + 2 y_1 + \cos(t).
\end{align*}</me>
			</p>

		</subsection>

		<subsection xml:id="applications">
			<title>Applications</title>

			<p>
				Let us consider some simple applications of systems and how to set up the equations.
			</p>


<example>
<title> </title>
<statement>			<p>
				 First, we consider salt and brine tanks, but this time water flows from one to the other and back. We again consider that the tanks are well-mixed.
			</p>

<!-- div attr= class="myfig"-->
<!--</div attr= class="myfig">-->

			<p>
				Suppose we have two tanks, each containing volume <m>V</m> liters of salt brine. The amount of salt in the first tank is <m>x_1</m> grams, and the amount of salt in the second tank is <m>x_2</m> grams. The liquid is perfectly mixed and flows at the rate <m>r</m> liters per second out of each tank into the other. See .
			</p>
</statement>

<solution>			<p>
				The rate of change of <m>x_1</m>, that is <m>x_1'</m>, is the rate of salt coming in minus the rate going out. The rate coming in is the density of the salt in tank 2, that is <m>\frac{x_2}{V}</m>, times the rate <m>r</m>. The rate coming out is the density of the salt in tank 1, that is <m>\frac{x_1}{V}</m>, times the rate <m>r</m>. In other words it is 
<me>
x_1' = \frac{x_2}{V} r - \frac{x_1}{V} r =
\frac{r}{V} x_2 - \frac{r}{V} x_1  = \frac{r}{V} (x_2-x_1).
</me>
 Similarly we find the rate <m>x_2'</m>, where the roles of <m>x_1</m> and <m>x_2</m> are reversed. All in all, the system of ODEs for this problem is <me>\begin{align*}
x_1' &amp; = \frac{r}{V} (x_2-x_1), \\
x_2' &amp; = \frac{r}{V} (x_1-x_2).
\end{align*}</me> In this system we cannot solve for <m>x_1</m> or <m>x_2</m> separately. We must solve for both <m>x_1</m> and <m>x_2</m> at once, which is intuitively clear since the amount of salt in one tank affects the amount in the other. We can’t know <m>x_1</m> before we know <m>x_2</m>, and vice versa.
			</p>

			<p>
				We don’t yet know how to find all the solutions, but intuitively we can at least find some solutions. Suppose we know that initially the tanks have the same amount of salt. That is, we have an initial condition such as <m>x_1(0)=x_2(0) = C</m>. Then clearly the amount of salt coming and out of each tank is the same, so the amounts are not changing. In other words, <m>x_1 = C</m> and <m>x_2 = C</m> (the constant functions) is a solution: <m>x_1' = x_2' = 0</m>, and <m>x_2-x_1 = x_1-x_2 = 0</m>, so the equations are satisfied.
			</p>

			<p>
				Let us think about the setup a little bit more without solving it. Suppose the initial conditions are <m>x_1(0) = A</m> and <m>x_2(0) = B</m>, for two different constants <m>A</m> and <m>B</m>. Since no salt is coming in or out of this closed system, the total amount of salt is constant. That is, <m>x_1+x_2</m> is constant, and so it equals <m>A+B</m>. Intuitively if <m>A</m> is bigger than <m>B</m>, then more salt will flow out of tank one than into it. Eventually, after a long time we would then expect the amount of salt in each tank to equalize. In other words, the solutions of both <m>x_1</m> and <m>x_2</m> should tend towards <m>\frac{A+B}{2}</m>. Once you know how to solve systems you will find out that this really is so.
			</p>
</solution>
</example>

<example>
<title> </title>
<statement>			<p>
				 Another example that showcases how systems work is different ways that populations of animals can interact. There are two main interactions that we will consider. The first of these is of two <q>competing species.</q> The idea here is that there are two species that are trying to coexist in a given area. On their own (without the other species), each one would grow exponentially, but any interaction between the two species is negative for both of them, because they share the types of food and other resources that they need to survive and grow. This gives rise to a system of differential equations of the form <me>\begin{split}
\frac{dx_1}{dt} &amp;= ax_1 - bx_1x_2 \\
\frac{dx_2}{dt} &amp;= cx_2 - dx_1x_2.
\end{split}</me>
			</p>

			<p>
				In the system here, the coefficient <m>a</m> represents the growth rate of species 1 on it’s own, <m>b</m> represents the amount to which the competition for resources affects the growth rate of species 1, <m>c</m> represents the growth rate of species 2, and <m>d</m> represents the magnitude of how the competition affects the growth of species 2. This type of system can also be written to contain logistic growth terms for the two species, resulting in <me>\begin{split}
\frac{dx_1}{dt} &amp;= ax_1(K_1 - x_1) - bx_1x_2 \\
\frac{dx_2}{dt} &amp;= cx_2(K_2 - x_2) - dx_1x_2.
\end{split}</me>
			</p>

			<p>
				The other main population model to consider is a <q>predator-prey</q> interaction. The key components of this model are that the prey population will grow on it’s own and the interaction between the two populations is negative, because the presence of predator population will cause the prey population to decrease. On the other hand, the predator population will die off on it’s own (without a food source) but the interaction with the prey population causes the predator population to increase. This gives rise to the system of differential equations <me>\begin{split}
\frac{dx}{dt} &amp;= ax - bxy \\
\frac{dy}{dt} &amp;= -cy + dxy
\end{split}</me> where <m>x</m> is the prey population and <m>y</m> is the predator population. We will take another look at both of these examples in once we have more terminology and techniques to discuss them.
			</p>
</statement>
</example>

<example>
<title> </title>
<statement>			<p>
				 Let us look at a second order example. We return to the mass and spring setup, but this time we consider two masses.
			</p>

<!-- div attr= class="mywrapfigsimp"-->
			<p>
				2.0in2.3in
			</p><!--</div attr= class="mywrapfigsimp">-->

			<p>
				Consider one spring with constant <m>k</m> and two masses <m>m_1</m> and <m>m_2</m>. Think of the masses as carts that ride along a straight track with no friction. Let <m>x_1</m> be the displacement of the first cart and <m>x_2</m> be the displacement of the second cart. That is, we put the two carts somewhere with no tension on the spring, and we mark the position of the first and second cart and call those the zero positions. Then <m>x_1</m> measures how far the first cart is from its zero position, and <m>x_2</m> measures how far the second cart is from its zero position. The force exerted by the spring on the first cart is <m>k(x_2-x_1)</m>, since <m>x_2-x_1</m> is how far the string is stretched (or compressed) from the rest position. The force exerted on the second cart is the opposite, thus the same thing with a negative sign. states that force equals mass times acceleration. So the system of equations is <me>\begin{align*}
m_1 x_1'' &amp; = k(x_2-x_1) , \\
m_2 x_2'' &amp; = - k(x_2-x_1) .
\end{align*}</me>
			</p>

			<p>
				Again, we cannot solve for the <m>x_1</m> or <m>x_2</m> variable separately. That we must solve for both <m>x_1</m> and <m>x_2</m> at once is intuitively clear, since where the first cart goes depends on exactly where the second cart goes and vice versa.
			</p>
</statement>
</example>
		</subsection>

		<subsection xml:id="changing-to-first-order">
			<title>Changing to first order</title>

			<p>
				Before we talk about how to handle systems, let us note that in some sense we need only consider first order systems. Let us take an <m>n^{\text{th}}</m> order differential equation 
<me>
y^{(n)} = F(y^{(n-1)},\ldots,y',y,x)
</me>
 that we would like to convert into a first order system. To do this, we first consider what a first order system would look like. A first order system consists of a set of equations involving the derivative of each of our variables. Let’s start with the first variable <m>u_1= y</m>. What is the derivative of <m>y</m>? Well, it’s <m>y'</m>, and we don’t have a way to represent this in terms of our variables (<m>u_1</m>) without any derivatives. So, we add a new variable <m>u_2</m> that we define to be <m>y'</m>, which makes the first equation in our system <m>u_1' = u_2</m>.
			</p>

			<p>
				Well, now we have <m>u_2</m> and we need to determine what its derivative is. Since <m>u_2 = y'</m>, <m>u_2' = y''</m>. If the order of the equation <m>n</m> is 2, we then have an equation to define what <m>y''</m> is in terms of <m>y'</m>, <m>y</m>, and <m>x</m>, which are <m>u_2</m>, <m>u_1</m>, and <m>x</m> in our new system. If that’s the case, we’re done, and if not, we need to define a new variable <m>u_3 = y''</m> so that <m>u_2' = u_3</m>. We can continue this process over and over again.
			</p>

			<p>
				When do we stop? As illustrated in the previous example with <m>n=2</m>, we stop when our derivative <m>u_n'</m> is the <m>n</m>th derivative of <m>y</m>. This works because our equation tells us exactly what <m>y^{(n)}</m> is in terms of lower order terms, which we have already defined variables for. Thus, we define new variables <m>u_1, u_2, \ldots, u_n</m> and write the system <me>\begin{align*}
u_1' &amp; = u_2 , \\
u_2' &amp; = u_3 , \\
&amp; ~\, \vdots \\
u_{n-1}' &amp; = u_n , \\
u_n' &amp; = F(u_n,u_{n-1},\ldots,u_2,u_1,x) .
\end{align*}</me> We solve this system for <m>u_1</m>, <m>u_2</m>, …, <m>u_n</m>. Once we have solved for the <m>u</m>’s, we can discard <m>u_2</m> through <m>u_n</m> and let <m>y = u_1</m>. This <m>y</m> solves the original equation.
			</p>


<example>
<title> </title>
<statement>			<p>
				Take <m>x''' = 2x''+ 8x' + x + t</m>. Convert this equation into a first order system.
			</p>
</statement>

<solution>			<p>
				Letting <m>u_1 = x</m>, <m>u_2 = x'</m>, <m>u_3
= x''</m>, we find the system: 
<me>
u_1' = u_2, \qquad u_2' = u_3, \qquad u_3' = 2u_3 + 8u_2 + u_1 + t.
</me>
 Since this is a linear system, we can also write this in matrix-vector form, which will be useful for systems that we will analyze later. To do this, we define a vector <m>\vec{u}</m> as 
<me>
\vec{u} = \begin{bmatrix} u_1 \\ u_2 \\ u_3 \end{bmatrix}.
</me>
 Then, we know that 
<me>
\vec{u}\ ` = \begin{bmatrix} u_1'\\ u_2'\\ u_3' \end{bmatrix} = \begin{bmatrix} u_2 \\ u_3 \\ 2u_3 + 8u_2 + u_1 + t \end{bmatrix}.
</me>
 We want to rewrite this equation using the vector <m>\vec{u}</m> and a matrix. We can rewrite this last vector as 
<me>
\begin{bmatrix} u_1'\\ u_2'\\ u_3' \end{bmatrix} = \begin{bmatrix} u_2 \\ u_3 \\ u_1 + 8u_2 + 2u_3 \end{bmatrix} + \begin{bmatrix}0 \\ 0 \\ t \end{bmatrix}
</me>
 and the right-hand side of this equation can be written as 
<me>
\vec{u}\ ` =  \begin{bmatrix} u_2 \\ u_3 \\ u_1 + 8u_2 + 2u_3 \end{bmatrix} + \begin{bmatrix}0 \\ 0 \\ t \end{bmatrix} = \begin{bmatrix} 0 &amp; 1 &amp; 0 \\ 0 &amp; 0 &amp; 1 \\ 1 &amp; 8 &amp; 2 \end{bmatrix} \vec{u} + \begin{bmatrix} 0 \\ 0 \\ t \end{bmatrix}. 
</me>
 (Verify that the matrix multiplication works out here!) Therefore, we can write this first order system as 
<me>
\vec{u}\ ` = \begin{bmatrix} 0 &amp; 1 &amp; 0 \\ 0 &amp; 0 &amp; 1 \\ 1 &amp; 8 &amp; 2 \end{bmatrix} \vec{u} + \begin{bmatrix} 0 \\ 0 \\ t \end{bmatrix}.
</me>

			</p>
</solution>
</example>
			<p>
				Note that if the equation above was non-linear, it would not be possible to write the system version in an appropriate matrix form. It is also important to know how to take initial conditions into account with these problems.
			</p>


<example>
<title> </title>
<statement>			<p>
				Convert the initial value problem 
<me>
x''' = 4e^t x'' - 3(x')^2 + t^2\sin(x) + (t^2 + 1) \qquad x(0) = 2,\ x'(0) = -1,\ x''(0) = 4
</me>
 into a system of first order equations. Simplify the expression as much as possible.
			</p>
</statement>

<solution>			<p>
				We follow the same procedure as the previous example. We define variables <m>u_1</m>, <m>u_2</m>, <m>u_3</m> as 
<me>
u_1 = x \quad u_2 = x' \quad u_3 = x''
</me>
 so that we have the differential equations 
<me>
u_1' = u_2 \quad u_2' = u_3 \quad u_3' = x''' = 4e^tu_3 - 3u_2^2 + t^2\sin(u_1) + (t^2 + 1)
</me>
 which we can write in vector form as 
<me>
\vec{u}' = \begin{bmatrix} u_1'\\ u_2'\\ u_3' \end{bmatrix} = \begin{bmatrix} u_2 \\ u_3 \\  4e^tu_3 - 3u_2^2 + t^2\sin(u_1) + (t^2 + 1) \end{bmatrix}.
</me>
 We would now want to try to convert this into matrix form. However, the matrix that we come up with should not depend on <m>u</m> at all. In this case, it would mean that we want to write this equation as 
<me>
\vec{u}\ ` = \begin{bmatrix} * &amp; * &amp; * \\ * &amp; * &amp; * \\ * &amp; * &amp; * \end{bmatrix} \begin{bmatrix} u_1 \\ u_2 \\ u_3 \end{bmatrix} + \begin{bmatrix} 0 \\ 0 \\ t^2 + 1 \end{bmatrix} 
</me>
 since the extra term needs to be everything that does not depend on <m>u</m>. However, while we can determine the first two rows of the matrix, we can not determine the last row. There is no way to pick terms <em>independent of <m>u</m></em> to fill in the three stars in the bottom row in order to make the bottom term in the matrix-vector product to equal <m>4e^tu_3 - 3u_2^2 + t^2\sin(u_1)</m>. The issue here is that the equation is non-linear; the <m>u_2^2</m> term and the <m>\sin(u_1)</m> term can not be written in this way. Therefore, the best we can do is the vector form, and it can’t be written in matrix form.
			</p>

			<p>
				The last thing we need to deal with is the initial conditions. Since the conditions say that 
<me>
x(0) = 2,\ x'(0) = -1,\ x''(0) = 4
</me>
 and we have that <m>u_1 = x,\ u_2 = x',\ u_3 = x''</m>, this means that the initial condition should be 
<me>
u_1(0) = 2,\ u_2(0) = -1,\ u_3(0) = 4,
</me>
 or 
<me>
\vec{u}(0) = \begin{bmatrix} 2 \\ -1 \\ 4 \end{bmatrix}.
</me>
 Thus, the full way to write this initial value problem in system form is 
<me>
\vec{u}' = \begin{bmatrix} u_2 \\ u_3 \\  4e^tu_3 - 3u_2^2 + t^2\sin(u_1) + (t^2 + 1) \end{bmatrix} \qquad \vec{u}(0) = \begin{bmatrix} 2 \\ -1 \\ 4 \end{bmatrix}.
</me>

			</p>
</solution>
</example>
			<p>
				A similar process can be followed for a system of higher order differential equations. For example, a system of <m>k</m> differential equations in <m>k</m> unknowns, all of order <m>n</m>, can be transformed into a first order system of <m>n \times k</m> equations and <m>n \times k</m> unknowns.
			</p>


<example>
<title> </title>
<statement>			<p>
				Consider the system from the carts example, 
<me>
m_1 x_1''  = k(x_2-x_1), \qquad m_2 x_2'' = - k(x_2-x_1) .
</me>
 Let <m>u_1 = x_1</m>, <m>u_2 = x_1'</m>, <m>u_3 = x_2</m>, <m>u_4 = x_2'</m>. The second order system becomes the first order system 
<me>
u_1' = u_2, \qquad
m_1 u_2'  = k(u_3-u_1), \qquad
u_3' = u_4, \qquad
m_2 u_4' = - k(u_3-u_1) .
</me>

			</p>
</statement>
</example>
	
<example>
<title> </title>
<statement>			<p>
				The idea works in reverse as well. Consider the system 
<me>
x' = 2y-x , \qquad
y' = x, 
</me>
 where the independent variable is <m>t</m>. We wish to solve for the initial conditions <m>x(0) = 1</m>, <m>y(0) =0</m>.
			</p>
</statement>

<solution>			<p>
				If we differentiate the second equation, we get <m>y''=x'</m>. We know what <m>x'</m> is in terms of <m>x</m> and <m>y</m>, and we know that <m>x=y'</m>. So, 
<me>
y'' = x' = 2y-x = 2y-y' .
</me>
 We now have the equation <m>y''+y'-2y = 0</m>. We know how to solve this equation and we find that <m>y = C_1 e^{-2t} + C_2 e^t</m>. Once we have <m>y</m>, we use the equation <m>y' = x</m> to get <m>x</m>. 
<me>
x = y' = -2 C_1 e^{-2t} + C_2 e^t .
</me>
 We solve for the initial conditions <m>1 = x(0) = -2 C_1 + C_2</m> and <m>0 = y(0) = C_1 + C_2</m>. Hence, <m>C_1 = -C_2</m> and <m>1 = 3C_2</m>. So <m>C_1 = \nicefrac{-1}{3}</m> and <m>C_2 = \nicefrac{1}{3}</m>. Our solution is 
<me>
x = \frac{2e^{-2t} + e^t}{3} ,\qquad
y = \frac{-e^{-2t} + e^t}{3} .
</me>

			</p>
</solution>
</example>
<exercise>
<statement>
			<p>
				Plug in and check that this really is the solution.
			</p>
</statement>

<answer>			<p>
				It is useful to go back and forth between systems and higher order equations for other reasons. For example, software for solving ODE numerically (approximation) is generally for first order systems. So to use it, you have to take whatever ODE you want to solve and convert it to a first order system. In fact, it is not very hard to adapt computer code for the Euler or Runge–Kutta method for first order equations to handle first order systems. We essentially just treat the dependent variable not as a number but as a vector. In many mathematical computer languages there is almost no distinction in syntax.
			</p>
</answer>
</exercise>

		</subsection>

		<subsection xml:id="autonomous-systems-and-vector-fields">
			<title>Autonomous systems and vector fields</title>

			<p>
				A system where the equations do not depend on the independent variable is called an <em></em>. For example the system <m>y'=2y-x</m>, <m>y'=x</m> is autonomous as <m>t</m> is the independent variable but does not appear in the equations.
			</p>

			<p>
				For autonomous systems we can draw the so-called <em></em> or <em></em>, a plot similar to a slope field, but instead of giving a slope at each point, we give a direction (and a magnitude). The previous example, <m>x' = 2y-x</m>, <m>y' = x</m>, says that at the point <m>(x,y)</m> the direction in which we should travel to satisfy the equations should be the direction of the vector <m>( 2y-x, x )</m> with the speed equal to the magnitude of this vector. So we draw the vector <m>(2y-x,x)</m> at the point <m>(x,y)</m> and we do this for many points on the <m>xy</m>-plane. For example, at the point <m>(1,2)</m> we draw the vector <m>\bigl(2(2)-1,1\bigr) = (3,1)</m>, a vector pointing to the right and a little bit up, while at the point <m>(2,1)</m> we draw the vector <m>\bigl(2(1)-2,2\bigr) = (0,2)</m> a vector that points straight up. When drawing the vectors, we will scale down their size to fit many of them on the same direction field. We are mostly interested in their direction and relative size. See .
			</p>

			<p>
				We can draw a path of the solution in the plane. Suppose the solution is given by <m>x = f(t)</m>, <m>y=g(t)</m>. We pick an interval of <m>t</m> (say <m>0 \leq t \leq 2</m> for our example) and plot all the points <m>\bigl(f(t),g(t)\bigr)</m> for <m>t</m> in the selected range. The resulting picture is called the <em></em> (or ). The particular curve obtained is called the <em></em> or <em></em>. See an example plot in . In the figure the solution starts at <m>(1,0)</m> and travels along the vector field for a distance of 2 units of <m>t</m>. We solved this system precisely, so we compute <m>x(2)</m> and <m>y(2)</m> to find <m>x(2) \approx 2.475</m> and <m>y(2) \approx 2.457</m>. This point corresponds to the top right end of the plotted solution curve in the figure.
			</p>

<!-- div attr= class="myfig"-->
<!--</div attr= class="myfig">-->

			<p>
				Notice the similarity to the diagrams we drew for autonomous systems in one dimension. But note how much more complicated things become when we allow just one extra dimension.
			</p>

			<p>
				We can draw phase portraits and trajectories in the <m>xy</m>-plane even if the system is not autonomous. In this case however we cannot draw the direction field, since the field changes as <m>t</m> changes. For each <m>t</m> we would get a different direction field.
			</p>

		</subsection>

		<subsection xml:id="picards-theorem">
			<title>Picard’s theorem</title>

			<p>
				Perhaps before going further, let us mention that Picard’s theorem on existence and uniqueness still holds for systems of ODE. Let us restate this theorem in the setting of systems. A general first order system is of the form 
<men xml:id="eq-general-system">
 \begin{aligned}
x_1' &amp; = F_1(x_1,x_2,\ldots,x_n,t) , \\
x_2' &amp; = F_2(x_1,x_2,\ldots,x_n,t) , \\
&amp; \vdots \\
x_n' &amp; = F_n(x_1,x_2,\ldots,x_n,t) .
\end{aligned}
</men>
			</p>

<!-- div attr= class="theorem1"-->
			<p>
				Picard’s theorem on existence and uniqueness for systems If for every <m>j=1,2,\ldots,n</m> and every <m>k = 1,2,\ldots,n</m> each <m>F_j</m> is continuous and the derivative <m>\frac{\partial F_j}{\partial x_k}</m> exists and is continuous near some <m>(x_1^0,x_2^0,\ldots,x_n^0,t^0)</m>, then a solution to <xref ref="eq-general-system" /> subject to the initial condition <m>x_1(t^0) = x_1^0</m>, <m>x_2(t^0) = x_2^0</m>, …, <m>x_n(t^0) = x_n^0</m> exists (at least for some small interval of <m>t</m>’s) and is unique.
			</p><!--</div attr= class="theorem1">-->

			<p>
				That is, a unique solution exists for any initial condition given that the system is reasonable (<m>F_j</m> and its partial derivatives in the <m>x</m> variables are continuous). As for single equations we may not have a solution for all time <m>t</m>, but at least for some short period of time.
			</p>

			<p>
				As we can change any <m>n</m>th order ODE into a first order system, then we notice that this theorem provides also the existence and uniqueness of solutions for higher order equations that we have until now not stated explicitly.
			</p>

		</subsection>

<exercises>
			<title>Exercises</title>

<exercise>
<statement>
			<p>
				Verify that <m>x_1(t) = 2e^{-t} - 2e^{-2t}</m>, <m>x_2(t) = e^{-t} - 2e^{-2t}</m> solves the system <m>x_1' = - 2x_2</m>, <m>x_2' = x_1 - 3x_2</m>.
			</p>
</statement>

<answer>			<p>
				 It works 
			</p>
</answer>
</exercise>

<exercise>
<statement>
			<p>
				Verify that <m>x_1(t) = -2te^{-3t} - 2e^{-3t}</m>, <m>x_2(t) = 2te^{-3t} + 3e^{-3t}</m> solves the system <m>x_1' = -5x_1 - 2x_2</m>, <m>x_2' = 2x_1 - x_2</m>.
			</p>
</statement>

<answer>			<p>
				 It works 
			</p>
</answer>
</exercise>

<exercise>
<statement>
			<p>
				Find the general solution of <m>x_1' = x_2 - x_1 + t</m>, <m>x_2' = x_2</m>.
			</p>
</statement>

<answer>			<p>
				 <m>x_1 = \frac{C_1}{2}e^t + (t-1) + C_2e^{-t}</m>, <m>x_2 = C_1e^t</m> 
			</p>
</answer>
</exercise>

<exercise>
<statement>
			<p>
				Find the general solution of <m>x_1' = 3 x_1 - x_2 + e^t</m>, <m>x_2' = x_1</m>.
			</p>
</statement>

<answer>			<p>
				 <m>x_1 = \frac{3+\sqrt{5}}{2}C_1e^{\frac{3+\sqrt{5}}{2}t} + \frac{3-\sqrt{5}}{2}C_2e^{\frac{3-\sqrt{5}}{2}t} - \frac{1}{2}Ae^t</m>, <m>x_2 = C_1e^{\frac{3+\sqrt{5}}{2}t} + C_2e^{\frac{3-\sqrt{5}}{2}t} - \frac{1}{2}Ae^t</m> 
			</p>
</answer>
</exercise>

<exercise>
<statement>
			<p>
				Find the general solution to <m>y_1' = 3 y_1</m>, <m>y_2' = y_1 + y_2</m>, <m>y_3' = y_1 + y_3</m>.
			</p>
</statement>

</exercise>
<exercise>
<statement>
			<p>
				Solve <m>y'=2x</m>, <m>x'=x+y</m>, <m>x(0)=1</m>, <m>y(0)=3</m>.
			</p>
</statement>

</exercise>
<exercise>
<statement>
			<p>
				Write <m>ay'' + by' + cy = f(x)</m> as a first order system of ODEs.
			</p>
</statement>

<answer>			<p>
				 <m>\vec{x}\ ' = \left[\begin{smallmatrix} 0 &amp; 1 \\ -\frac{c}{a} &amp; -\frac{b}{a} \end{smallmatrix}\right] \vec{x} + \left[\begin{smallmatrix}  0 \\ \frac{1}{a}f(x) \end{smallmatrix}\right]</m> 
			</p>
</answer>
</exercise>

<exercise>
<statement>
			<p>
				Write <m>x'' + y^2 y' - x^3 = \sin(t)</m>, <m>y'' + {(x'+y')}^2 -x = 0</m> as a first order system of ODEs.
			</p>
</statement>

<answer>			<p>
				 <m>\left[\begin{smallmatrix} u_1 \\ u_2 \\ u_3 \\ u_4 \end{smallmatrix}\right]' = \left[\begin{smallmatrix} u_2 \\ \sin(t) + u_1^3 - u_3^2u_4 \\ u_4 \\ u_1 - (u_3 + u_4)^2 \end{smallmatrix}\right]</m> 
			</p>
</answer>
</exercise>

<exercise>
<statement>
			<p>
				Write <m>x''' = x+t</m> as a first order system.
			</p>
</statement>

</exercise>
<exercise>
<statement>
			<p>
				Write <m>y_1'' + y_1 + y_2 = t</m>, <m>y_2'' + y_1 - y_2 = t^2</m> as a first order system.
			</p>
</statement>

</exercise>
<exercise>
<statement>
			<p>
				Write <m>y^{(4)} - t^2 y''' + e^t y' - (2t+1)y = \cos(t)</m> as a first order system.
			</p>
</statement>

<answer>			<p>
				 <m>\vec{u}' = \left[\begin{smallmatrix}  0 &amp; 1 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 1 &amp; 0 \\ 0 &amp; 0 &amp; 0 &amp; 1 \\ 2t+1 &amp; -e^t &amp; 0 &amp; t^2 \end{smallmatrix}\right]\vec{u} + \left[\begin{smallmatrix} 0 \\ 0 \\ 0 \\ \cos(t) \end{smallmatrix}\right]</m> 
			</p>
</answer>
</exercise>

<exercise>
<statement>
			<p>
				Write the initial value problem <me>y'' - 2xy' + 3y = \sin(x) \qquad y(0) = 1,\ y'(0) = -2</me> as an initial value problem for a first order system of ODEs. Make sure to indicate how the initial condition appears as a part of this problem.
			</p>
</statement>

<answer>			<p>
				 <m>\vec{u}' = \left[\begin{smallmatrix}  0 &amp; 1 \\ -3 &amp; 2x \end{smallmatrix}\right]\vec{x} + \left[\begin{smallmatrix}  0 \\ \sin(x) \end{smallmatrix}\right]</m>, <m>\vec{u}(0) = \left[\begin{smallmatrix}  1 \\ -2 \end{smallmatrix}\right]</m> 
			</p>
</answer>
</exercise>

<exercise>
<statement>
			<p>
				Write the initial value problem <me>y'' - (y+1)^2 y' - e^{xy} = \cos(x) \qquad y(0) = -1,\ y'(0) = 5</me> as an initial value problem for a first order system of ODEs. Make sure to indicate how the initial condition appears as a part of this problem. Can this be written in matrix form? Why or why not?
			</p>
</statement>

<answer>			<p>
				 <m>\vec{u}' = \left[\begin{smallmatrix}  u_2 \\ \cos(x) + e^{xu_1} + (u_1 + 1)^2u_2 \end{smallmatrix}\right]</m>, <m>\vec{u}(0) = \left[\begin{smallmatrix}  -1 \\ 5 \end{smallmatrix}\right]</m>. Non-linear. 
			</p>
</answer>
</exercise>

<exercise>
<statement>
			<p>
				Write the initial value problem <me>y^{(4)} + e^x y'' - 4\cos(x)y' + (x^2 + 1)y = \frac{1}{x-3} \qquad y(0) = 2,\ y'(0) = -3,\ y''(0) = 0,\ y^{(3)}(0) = 1</me> as an initial value problem for a first order system of ODEs. Make sure to indicate how the initial condition appears as a part of this problem.
			</p>
</statement>

<answer>			<p>
				 <m>\vec{u}' = \left[\begin{smallmatrix}  0 &amp; 1 &amp; 0 &amp; 0 \\ 0 &amp; 0 &amp; 1 &amp; 0 \\ 0 &amp; 0 &amp; 0 &amp; 1 \\ -(x^2 + 1) &amp; 4\cos(x) &amp; -e^x &amp; 0 \end{smallmatrix}\right] \vec{u} + \left[\begin{smallmatrix} 0 \\ 0 \\ 0 \\ \frac{1}{x-3} \end{smallmatrix}\right]</m>, <m>\vec{u}(0) = \left[\begin{smallmatrix} -2 \\ -3 \\ 0 \\ 1 \end{smallmatrix}\right]</m>. 
			</p>
</answer>
</exercise>

<exercise>
<statement>
			<p>
				Suppose two masses on carts on frictionless surface are at displacements <m>x_1</m> and <m>x_2</m> as in . Suppose that a rocket applies force <m>F</m> in the positive direction on cart <m>x_1</m>. Set up the system of equations.
			</p>
</statement>

<answer>			<p>
				 <m>mx_1'' = k(x_2 - x_1) + F,\ mx_2''  =-k(x_2 - x_1)</m> 
			</p>
</answer>
</exercise>

<exercise>
<statement>
			<p>
				Suppose two masses on carts on frictionless surface are at displacements <m>x_1</m> and <m>x_2</m> as in . Suppose initial displacement is <m>x_1(0)=x_2(0)=0</m>, and initial velocity is <m>x_1'(0) = x_2'(0) = a</m> for some number <m>a</m>. Use your intuition to solve the system, explain your reasoning.
			</p>
</statement>

</exercise>
<exercise>
<statement>
			<p>
				Suppose the tanks are as in , starting both at volume <m>V</m>, but now the rate of flow from tank 1 to tank 2 is <m>r_1</m>, and rate of flow from tank 2 to tank 1 is <m>r_2</m>. In particular, the volumes will now be changing. Set up the system of equations.
			</p>
</statement>

<answer>			<p>
				 <m>V_1(t) = V + (r_2 - r_1)t</m>, <m>V_2(t) = V + (r_1 - r_2)t</m><!-- linebreak --><m>\frac{dx_1}{dt} = r_2\left(\frac{x_2}{V + (r_1 - r_2)t}\right)  - r_1\left(\frac{x_1}{V + (r_2 - r_1)t}\right)</m> <m>\frac{dx_2}{dt} = r_1\left(\frac{x_1}{V + (r_2 - r_1)t}\right)  - r_2\left(\frac{x_2}{V + (r_1 - r_2)t}\right)</m><!-- linebreak -->
			</p>
</answer>
</exercise>

<exercise>
<statement>
			<p>
				Suppose the tanks are as in except that clean water flows in at the rate <m>s</m> liters per second into tank 1, and brine flows out of tank 2 and into the sewer also at the rate of <m>s</m> liters per second. We also adjust the flow rate of the line from tank 1 to tank 2 to be <m>r+s</m> liters per second.
			</p>

<!-- div attr= class="tasks"-->
			<p>
				Draw the picture. Set up the system of equations. Intuitively, what happens as <m>t</m> goes to infinity, explain.
			</p><!--</div attr= class="tasks">-->
</statement>

</exercise>
<exercise>
<statement>
			<p>
				Match the systems of differential equations below to their corresponding slope fields. Justify. 
<me>
(i)\ \begin{cases} \frac{dx}{dt} &amp;= x+y \\ \frac{dy}{dt} &amp;= 2y-x \end{cases} \qquad (ii)\ \begin{cases} \frac{dx}{dt} &amp;= x-y \\ \frac{dy}{dt} &amp;= x^2 + y \end{cases} \qquad (iii)\ \begin{cases} \frac{dx}{dt} &amp;= x^2 - y^2 \\ \frac{dy}{dt} &amp;= 3x-1 \end{cases}
</me>

			</p>

<!-- div attr= class="tasks"-->
			<p>
				(3)
			</p>

			<figure>
	<image source="Images/sysslopeEx1_1"/>
				<caption>image</caption>
</figure>

			<figure>
	<image source="Images/sysslopeEx1_3"/>
				<caption>image</caption>
</figure>

			<figure>
	<image source="Images/sysslopeEx1_2"/>
				<caption>image</caption>
</figure><!--</div attr= class="tasks">-->
</statement>

</exercise>
<exercise>
<statement>
			<p>
				Match the systems of differential equations below to their corresponding slope fields. Justify. 
<me>
(i)\ \begin{cases} \frac{dx}{dt} &amp;= 2x+y \\ \frac{dy}{dt} &amp;= y - x^2 \end{cases} \qquad (ii)\ \begin{cases} \frac{dx}{dt} &amp;= x^2 \\ \frac{dy}{dt} &amp;= x-y \end{cases} \qquad (iii)\ \begin{cases} \frac{dx}{dt} &amp;= y+2 \\ \frac{dy}{dt} &amp;= x+y+1 \end{cases}
</me>

			</p>

<!-- div attr= class="tasks"-->
			<p>
				(3)
			</p>

			<figure>
	<image source="Images/sysslopeEx2_3"/>
				<caption>image</caption>
</figure>

			<figure>
	<image source="Images/sysslopeEx2_2"/>
				<caption>image</caption>
</figure>

			<figure>
	<image source="Images/sysslopeEx2_1"/>
				<caption>image</caption>
</figure><!--</div attr= class="tasks">-->
</statement>
</exercise></exercises>

	</section>



