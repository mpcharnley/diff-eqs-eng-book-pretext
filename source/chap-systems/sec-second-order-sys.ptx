<?xml version="1.0" encoding="UTF-8" ?>
<!-- Generated by Pandoc using pretext.lua -->



	<section xml:id="sol-section">
		<title>Second order systems and applications</title>


		<subsection xml:id="undamped-mass-spring-systems">
			<title>Undamped mass-spring systems</title>

			<p>
				While we did say that we will usually only look at first order systems, it is sometimes more convenient to study the system in the way it arises naturally. For example, suppose we have 3 masses connected by springs between two walls. We could pick any higher number, and the math would be essentially the same, but for simplicity we pick 3 right now. Let us also assume no friction, that is, the system is undamped. The masses are <m>m_1</m>, <m>m_2</m>, and <m>m_3</m> and the spring constants are <m>k_1</m>, <m>k_2</m>, <m>k_3</m>, and <m>k_4</m>. Let <m>x_1</m> be the displacement from rest position of the first mass, and <m>x_2</m> and <m>x_3</m> the displacement of the second and third mass. We make, as usual, positive values go right (as <m>x_1</m> grows, the first mass is moving right). See .
			</p>

<!-- div attr= class="myfig"-->
<!--</div attr= class="myfig">-->

			<p>
				This simple system turns up in unexpected places. For example, our world really consists of many small particles of matter interacting together. When we try the system above with many more masses, we obtain a good approximation to how an elastic material behaves.
			</p>

			<p>
				Let us set up the equations for the . By , the force acting on the mass equals the spring compression times the spring constant. By , force is mass times acceleration. So if we sum the forces acting on each mass, put the right sign in front of each term, depending on the direction in which it is acting, and set this equal to mass times the acceleration, we end up with the desired system of equations. 
<me>
\begin{aligned}
m_1 x_1'' &amp;= -k_1 x_1 + k_2 (x_2-x_1)
&amp; &amp; = -(k_1+k_2) x_1 + k_2 x_2 , \\
m_2 x_2'' &amp;= -k_2 (x_2-x_1) + k_3 (x_3-x_2)
&amp; &amp; = k_2 x_1 -(k_2+k_3) x_2 + k_3 x_3 , \\
m_3 x_3'' &amp;= -k_3 (x_3-x_2) - k_4 x_3
&amp; &amp; = k_3 x_2 - (k_3+k_4) x_3 . 
\end{aligned}
</me>
 We define the matrices 
<me>
M =
\begin{bmatrix}
m_1 &amp; 0 &amp; 0 \\
0 &amp; m_2 &amp; 0 \\
0 &amp; 0 &amp; m_3
\end{bmatrix}
\qquad
\text{and}
\qquad
K =
\begin{bmatrix}
-(k_1+k_2) &amp; k_2 &amp; 0 \\
k_2 &amp; -(k_2+k_3) &amp; k_3 \\
0 &amp; k_3 &amp; -(k_3+k_4)
\end{bmatrix} .
</me>
 We write the equation simply as 
<me>
M {\vec{x}}'' = K \vec{x} .
</me>
 At this point we could introduce 3 new variables and write out a system of 6 first order equations. We claim this simple setup is easier to handle as a second order system. We call <m>\vec{x}</m> the <em></em>, <m>M</m> the <em></em>, and <m>K</m> the <em></em>.
			</p>

<exercise>
<statement>
			<p>
				Repeat this setup for 4 masses (find the matrices <m>M</m> and <m>K</m>). Do it for 5 masses. Can you find a prescription to do it for <m>n</m> masses?
			</p>
</statement>

<answer>			<p>
				As with a single equation we want to This means computing the inverse of <m>M</m>. The masses are all nonzero and <m>M</m> is a diagonal matrix, so computing the inverse is easy: 
<me>
M^{-1} =
\begin{bmatrix}
\frac{1}{m_1} &amp; 0 &amp; 0 \\
0 &amp; \frac{1}{m_2} &amp; 0 \\
0 &amp; 0 &amp; \frac{1}{m_3}
\end{bmatrix} .
</me>
 This fact follows readily by how we multiply diagonal matrices. As an exercise, you should verify that <m>M M^{-1} = M^{-1} M = I</m>.
			</p>
</answer>
</exercise>

			<p>
				Let <m>A = M^{-1}K</m>. We look at the system <m>{\vec{x}}'' = M^{-1}K \vec{x}</m>, or 
<me>
{\vec{x}}'' = A \vec{x} .
</me>
 Many real world systems can be modeled by this equation. For simplicity, we will only talk about the given masses-and-springs problem. We try a solution of the form 
<me>
\vec{x} = \vec{v} e^{\alpha t} .
</me>
 We compute that for this guess, <m>{\vec{x}}'' = \alpha^2 \vec{v} e^{\alpha t}</m>. We plug our guess into the equation and get 
<me>
\alpha^2 \vec{v} e^{\alpha t} = A\vec{v} e^{\alpha t} .
</me>
 We divide by <m>e^{\alpha t}</m> to arrive at <m>\alpha^2 \vec{v} = A\vec{v}</m>. Hence if <m>\alpha^2</m> is an eigenvalue of <m>A</m> and <m>\vec{v}</m> is a corresponding eigenvector, we have found a solution.
			</p>

			<p>
				In our example, and in other common applications, <m>A</m> has only real negative eigenvalues (and possibly a zero eigenvalue). So we study only this case. When an eigenvalue <m>\lambda</m> is negative, it means that <m>\alpha^2 = \lambda</m> is negative. Hence there is some real number <m>\omega</m> such that <m>-\omega^2 = \lambda</m>. Then <m>\alpha = \pm i \omega</m>. The solution we guessed was 
<me>
\vec{x} = \vec{v} \, \bigl(\cos (\omega t) + i \sin (\omega t) \bigr) .
</me>
 By taking the real and imaginary parts (note that <m>\vec{v}</m> is real), we find that <m>\vec{v} \cos (\omega t)</m> and <m>\vec{v} \sin (\omega t)</m> are linearly independent solutions.
			</p>

			<p>
				If an eigenvalue is zero, it turns out that both <m>\vec{v}</m> and <m>\vec{v} t</m> are solutions, where <m>\vec{v}</m> is an eigenvector corresponding to the eigenvalue 0.
			</p>

<exercise>
<statement>
			<p>
				Show that if <m>A</m> has a zero eigenvalue and <m>\vec{v}</m> is a corresponding eigenvector, then <m>\vec{x} = \vec{v} (a + bt)</m> is a solution of <m>{\vec{x}}'' = A \vec{x}</m> for arbitrary constants <m>a</m> and <m>b</m>.
			</p>
</statement>

</exercise>
<!-- div attr= class="theorem1"-->
			<p>
				Let <m>A</m> be a real <m>n \times n</m> matrix with <m>n</m> distinct real negative (or zero) eigenvalues we denote by <m>-\omega_1^2 &gt; -\omega_2^2 &gt; \cdots &gt; -\omega_n^2</m>, and corresponding eigenvectors by <m>\vec{v}_1</m>, <m>\vec{v}_2</m>, …, <m>\vec{v}_n</m>. If <m>A</m> is invertible (that is, if <m>\omega_1 &gt; 0</m>), then 
<me>
%\mybxbg{~~
\vec{x}(t)
= \sum_{i=1}^n \vec{v}_i \bigl(a_i \cos (\omega_i t) + b_i \sin (\omega_i t) \bigr) ,
%~~}
</me>
 is the general solution of 
<me>
{\vec{x}}'' = A \vec{x},
</me>
 for some arbitrary constants <m>a_i</m> and <m>b_i</m>. If <m>A</m> has a zero eigenvalue, that is <m>\omega_1 = 0</m>, and all other eigenvalues are distinct and negative, then the general solution can be written as 
<me>
%\mybxbg{~~
\vec{x}(t) = \vec{v}_1 (a_1 + b_1 t) +
\sum_{i=2}^n \vec{v}_i \bigl(a_i \cos (\omega_i t) + b_i \sin (\omega_i t) \bigr) .
%~~}
</me>

			</p><!--</div attr= class="theorem1">-->

			<p>
				We use this solution and the setup from the introduction of this section even when some of the masses and springs are missing. For example, when there are only 2 masses and only 2 springs, simply take only the equations for the two masses and set all the spring constants for the springs that are missing to zero.
			</p>

		</subsection>

		<subsection xml:id="examples">
			<title>Examples</title>


<example>
<title> </title>
<statement>			<p>
				Consider the setup in , with <m>m_1 = \unit[2]{kg}</m>, <m>m_2 = \unit[1]{kg}</m>, <m>k_1 = \unitfrac[4]{N}{m}</m>, and <m>k_2 = \unitfrac[2]{N}{m}</m>.
			</p>

<!-- div attr= class="myfig"-->
<!--</div attr= class="myfig">-->
</statement>

<solution>			<p>
				The equations we write down are 
<me>
\begin{bmatrix}
2 &amp; 0 \\
0 &amp; 1
\end{bmatrix}
{\vec{x}}'' =
\begin{bmatrix}
-(4+2) &amp; 2 \\
2 &amp; -2
\end{bmatrix}
\vec{x} ,
</me>
 or 
<me>
{\vec{x}}'' =
\begin{bmatrix}
-3 &amp; 1 \\
2 &amp; -2
\end{bmatrix}
\vec{x} .
</me>

			</p>

			<p>
				We find the eigenvalues of <m>A</m> to be <m>\lambda = -1, -4</m> (exercise). We find corresponding eigenvectors to be <m>\left[ \begin{smallmatrix} 1 \\ 2 \end{smallmatrix} \right]</m> and <m>\left[ \begin{smallmatrix} 1 \\ -1 \end{smallmatrix} \right]</m> respectively (exercise).
			</p>

			<p>
				We check the theorem and note that <m>\omega_1 = 1</m> and <m>\omega_2 = 2</m>. Hence the general solution is 
<me>
\vec{x} = 
\begin{bmatrix} 1 \\ 2 \end{bmatrix}
\bigl( a_1 \cos (t) + b_1 \sin (t) \bigr)
+
\begin{bmatrix} 1 \\ -1 \end{bmatrix}
\bigl( a_2 \cos (2t) + b_2 \sin (2t) \bigr) .
</me>

			</p>

			<p>
				The two terms in the solution represent the two so-called <em>natural</em> or <em>normal modes of oscillation</em>. And the two (angular) frequencies are the <em>natural frequencies</em>. The first natural frequency is 1, and second natural frequency is 2. The two modes are plotted in .
			</p>

<!-- div attr= class="myfig"-->
<!--</div attr= class="myfig">-->

			<p>
				Let us write the solution as 
<me>
\vec{x} = 
\begin{bmatrix} 1 \\ 2 \end{bmatrix}
c_1 \cos (t - \alpha_1 )
+
\begin{bmatrix} 1 \\ -1 \end{bmatrix}
c_2 \cos (2t - \alpha_2 ) .
</me>
 The first term, 
<me>
\begin{bmatrix} 1 \\ 2 \end{bmatrix}
c_1 \cos (t - \alpha_1 )
=
\begin{bmatrix}
c_1 \cos (t - \alpha_1 ) \\
2c_1 \cos (t - \alpha_1 )
\end{bmatrix} ,
</me>
 corresponds to the mode where the masses move synchronously in the same direction.
			</p>

			<p>
				The second term, 
<me>
\begin{bmatrix} 1 \\ -1 \end{bmatrix}
c_2 \cos (2t - \alpha_2 )
=
\begin{bmatrix}
c_2 \cos (2t - \alpha_2 ) \\
- c_2 \cos (2t - \alpha_2 )
\end{bmatrix} ,
</me>
 corresponds to the mode where the masses move synchronously but in opposite directions.
			</p>

			<p>
				The general solution is a combination of the two modes. That is, the initial conditions determine the amplitude and phase shift of each mode. As an example, suppose we have initial conditions 
<me>
\vec{x}(0) = 
\begin{bmatrix} 1 \\ -1 \end{bmatrix}
, \qquad
\vec{x}'(0) = 
\begin{bmatrix} 0 \\ 6 \end{bmatrix} .
</me>
 We use the <m>a_j, b_j</m> constants to solve for initial conditions. First 
<me>
\begin{bmatrix} 1 \\ -1 \end{bmatrix}
=
\vec{x}(0) = 
\begin{bmatrix} 1 \\ 2 \end{bmatrix}
a_1
+
\begin{bmatrix} 1 \\ -1 \end{bmatrix}
a_2 
=
\begin{bmatrix} a_1+a_2 \\2a_1 - a_2 \end{bmatrix} .
</me>
 We solve (exercise) to find <m>a_1 = 0</m>, <m>a_2 = 1</m>. To find the <m>b_1</m> and <m>b_2</m>, we differentiate first: 
<me>
{\vec{x}}' = 
\begin{bmatrix} 1 \\ 2 \end{bmatrix}
\bigl( - a_1 \sin (t) + b_1 \cos (t) \bigr)
+
\begin{bmatrix} 1 \\ -1 \end{bmatrix}
\bigl( - 2a_2 \sin (2t) + 2 b_2 \cos (2t) \bigr) .
</me>
 Now we solve: 
<me>
\begin{bmatrix} 0 \\ 6 \end{bmatrix}
=
{\vec{x}}'(0) = 
\begin{bmatrix} 1 \\ 2 \end{bmatrix}
b_1
+
\begin{bmatrix} 1 \\ -1 \end{bmatrix}
2 b_2
=
\begin{bmatrix} b_1+2b_2 \\ 2b_1-2b_2 \end{bmatrix} .
</me>
 Again solve (exercise) to find <m>b_1 = 2</m>, <m>b_2 = -1</m>. So our solution is 
<me>
\vec{x} = 
\begin{bmatrix} 1 \\ 2 \end{bmatrix}
2 \sin (t)
+
\begin{bmatrix} 1 \\ -1 \end{bmatrix}
\bigl( \cos (2t) - \sin (2t) \bigr)
=
\begin{bmatrix}
2 \sin (t) + \cos(2t)- \sin(2t) \\
4 \sin (t) - \cos(2t) + \sin(2t)
\end{bmatrix} .
</me>
 The graphs of the two displacements, <m>x_1</m> and <m>x_2</m> of the two carts is in .
			</p>

<!-- div attr= class="myfig"-->
<!--</div attr= class="myfig">-->
</solution>
</example>

<example>
<title> </title>
<statement>			<p>
				 We have two toy rail cars. Car 1 of mass kg is traveling at towards the second rail car of mass kg. There is a bumper on the second rail car that engages at the moment the cars hit (it connects to two cars) and does not let go. The bumper acts like a spring of spring constant <m>k=\unitfrac[2]{N}{m}</m>. The second car is 10 meters from a wall. See .
			</p>

<!-- div attr= class="myfig"-->
<!--</div attr= class="myfig">-->

			<p>
				We want to ask several questions. At what time after the cars link does impact with the wall happen? What is the speed of car 2 when it hits the wall?
			</p>
</statement>

<solution>			<p>
				OK, let us first set the system up. Let <m>t=0</m> be the time when the two cars link up. Let <m>x_1</m> be the displacement of the first car from the position at <m>t=0</m>, and let <m>x_2</m> be the displacement of the second car from its original location. Then the time when <m>x_2(t) = 10</m> is exactly the time when impact with wall occurs. For this <m>t</m>, <m>x_2'(t)</m> is the speed at impact. This system acts just like the system of the previous example but without <m>k_1</m>. Hence the equation is 
<me>
\begin{bmatrix}
2 &amp; 0 \\
0 &amp; 1
\end{bmatrix}
{\vec{x}}'' =
\begin{bmatrix}
-2 &amp; 2 \\
2 &amp; -2
\end{bmatrix}
\vec{x} ,
</me>
 or 
<me>
{\vec{x}}'' =
\begin{bmatrix}
-1 &amp; 1 \\
2 &amp; -2
\end{bmatrix}
\vec{x} .
</me>

			</p>

			<p>
				We compute the eigenvalues of <m>A</m>. It is not hard to see that the eigenvalues are 0 and <m>-3</m> (exercise). Furthermore, eigenvectors are <m>\left[ \begin{smallmatrix} 1 \\ 1 \end{smallmatrix} \right]</m> and <m>\left[ \begin{smallmatrix} 1 \\ -2 \end{smallmatrix} \right]</m> respectively (exercise). Then <m>\omega_1 = 0</m>, <m>\omega_2 = \sqrt{3}</m>, and by the second part of the theorem the general solution is 
<me>
\begin{split}
\vec{x} &amp; = 
\begin{bmatrix} 1 \\ 1 \end{bmatrix}
\left( a_1 + b_1 t \right) 
+
\begin{bmatrix} 1 \\ -2 \end{bmatrix}
\left( a_2 \cos ( \sqrt{3} \, t) + b_2 \sin ( \sqrt{3} \, t ) \right)
\\
&amp; =
\begin{bmatrix}
a_1 + b_1 t + a_2 \cos ( \sqrt{3} \, t ) + b_2 \sin ( \sqrt{3} \, t
) \\
a_1 + b_1 t - 2 a_2 \cos ( \sqrt{3} \, t ) - 2 b_2 \sin ( \sqrt{3}
\, t ) 
\end{bmatrix} .
\end{split}
</me>

			</p>

			<p>
				We now apply the initial conditions. First the cars start at position 0 so <m>x_1 (0) = 0</m> and <m>x_2(0) = 0</m>. The first car is traveling at , so <m>x_1'(0) = 3</m> and the second car starts at rest, so <m>x_2'(0) = 0</m>. The first conditions says 
<me>
\vec{0} = \vec{x}(0) = 
\begin{bmatrix}
a_1 + a_2 \\
a_1 - 2 a_2 
\end{bmatrix} .
</me>
 It is not hard to see that <m>a_1 = a_2 = 0</m>. We set <m>a_1=0</m> and <m>a_2=0</m> in <m>\vec{x}(t)</m> and differentiate to get 
<me>
{\vec{x}}'(t)
=
\begin{bmatrix}
b_1 + \sqrt{3} \, b_2 \cos ( \sqrt{3} \, t ) \\
b_1 - 2 \sqrt{3} \, b_2 \cos ( \sqrt{3} \, t )
\end{bmatrix} .
</me>
 So 
<me>
\begin{bmatrix} 3 \\ 0 \end{bmatrix} = 
{\vec{x}}'(0)
=
\begin{bmatrix}
b_1 + \sqrt{3} \, b_2 \\
b_1 - 2 \sqrt{3} \, b_2 
\end{bmatrix} .
</me>
 Solving these two equations we find <m>b_1 = 2</m> and <m>b_2 =
\frac{1}{\sqrt{3}}</m>. Hence the position of our cars is (until the impact with the wall) 
<me>
\vec{x} = 
\begin{bmatrix}
2 t + \frac{1}{\sqrt{3}} \sin ( \sqrt{3} \, t ) \\
2 t - \frac{2}{\sqrt{3}} \sin ( \sqrt{3} \, t )
\end{bmatrix} .
</me>
 Note how the presence of the zero eigenvalue resulted in a term containing <m>t</m>. This means that the cars will be traveling in the positive direction as time grows, which is what we expect.
			</p>

			<p>
				What we are really interested in is the second expression, the one for <m>x_2</m>. We have <m>x_2(t) = 
2 t - \frac{2}{\sqrt{3}} \sin ( \sqrt{3} \, t)</m>. See for the plot of <m>x_2</m> versus time.
			</p>

			<p>
				Just from the graph we can see that time of impact will be a little more than 5 seconds from time zero. For this we have to solve the equation <m>10 = x_2(t) = 2 t - \frac{2}{\sqrt{3}} \sin ( \sqrt{3} \,
t)</m>. Using a computer (or even a graphing calculator) we find that <m>t_{\text{impact}} \approx 5.22</m> seconds.
			</p>

<!-- div attr= class="mywrapfig"-->
			<p>
				3.25in
			</p><!--</div attr= class="mywrapfig">-->

			<p>
				The speed of the second car is <m>x_2' = 2 - 2 \cos ( \sqrt{3} \, t)</m>. At the time of impact (5.22 seconds from <m>t=0</m>) we get <m>x_2'(t_{\text{impact}}) \approx 3.85</m>. The maximum speed is the maximum of <m>2 - 2 \cos ( \sqrt{3} \, t )</m>, which is 4. We are traveling at almost the maximum speed when we hit the wall.
			</p>

			<p>
				Suppose that Bob is a tiny person sitting on car 2. Bob has a Martini in his hand and would like not to spill it. Let us suppose Bob would not spill his Martini when the first car links up with car 2, but if car 2 hits the wall at any speed greater than zero, Bob will spill his drink. Suppose Bob can move car 2 a few meters towards or away from the wall (he cannot go all the way to the wall, nor can he get out of the way of the first car). Is there a distance for him to be at? A distance such that the impact with the wall is at zero speed?
			</p>

			<p>
				The answer is yes. Looking at , we note the between <m>t=3</m> and <m>t=4</m>. There is a point where the speed is zero. To find it we solve <m>x_2'(t) = 0</m>. This is when <m>\cos ( \sqrt{3} \, t) = 1</m> or in other words when <m>t = \frac{2 \pi}{\sqrt{3}}, 
\frac{4 \pi}{\sqrt{3}},\ldots</m> and so on. We plug in the first value to obtain <m>x_2\left(\frac{2 \pi}{\sqrt{3}}\right) = 
\frac{4 \pi}{\sqrt{3}} \approx 7.26</m>. So a distance is about 7 and a quarter meters from the wall.
			</p>

			<p>
				Alternatively Bob could move away from the wall towards the incoming car 2, where another safe distance is <m>x_2 \left( \frac{4 \pi}{\sqrt{3}} \right) = \frac{8 \pi}{\sqrt{3}}
\approx 14.51</m> and so on. We can use all the different <m>t</m> such that <m>x_2'(t) = 0</m>. Of course <m>t=0</m> is also a solution, corresponding to <m>x_2 = 0</m>, but that means standing right at the wall.
			</p>
</solution>
</example>
		</subsection>

		<subsection xml:id="forced-oscillations">
			<title>Forced oscillations</title>

			<p>
				Finally we move to forced oscillations. Suppose that now our system is 
<men xml:id="sosa-forcedeq">
 {\vec{x}}'' = A \vec{x} + \vec{F} \cos ( \omega t) .
</men>
That is, we are adding periodic forcing to the system in the direction of the vector <m>\vec{F}</m>.
			</p>

			<p>
				As before, this system just requires us to find one particular solution <m>\vec{x}_p</m>, add it to the general solution of the associated homogeneous system <m>\vec{x}_c</m>, and we will have the general solution to <xref ref="sosa-forcedeq" />. Let us suppose that <m>\omega</m> is not one of the natural frequencies of <m>{\vec{x}}'' = A \vec{x}</m>, then we can guess 
<me>
\vec{x}_p = \vec{c} \cos (\omega t) ,
</me>
 where <m>\vec{c}</m> is an unknown constant vector. Note that we do not need to use sine since there are only second derivatives. We solve for <m>\vec{c}</m> to find <m>\vec{x}_p</m>. This is really just the method of <em>undetermined coefficients</em> for systems. Let us differentiate <m>\vec{x}_p</m> twice to get 
<me>
{\vec{x}_p}'' = -\omega^2 \vec{c} \cos (\omega t) .
</me>
 Plug <m>\vec{x}_p</m> and <m>{\vec{x}_p}''</m> into equation <xref ref="sosa-forcedeq" />: 
<me>
\overbrace{
-\omega^2 \vec{c} \cos (\omega t)
}^{{\vec{x}_p}''}
=
\overbrace{
A \vec{c} \cos (\omega t) 
}^{A \vec{x}_p}
+ \vec{F} \cos (\omega t) .
</me>
 We cancel out the cosine and rearrange the equation to obtain 
<me>
(A +\omega^2 I) \vec{c}
=
- \vec{F} .
</me>
 So 
<me>
\vec{c}
=
{(A +\omega^2 I)}^{-1}
(-\vec{F} ).
</me>
 Of course this is possible only if <m>(A+ \omega^2 I) = \bigl(A- (-\omega^2) I\bigr)</m> is invertible. That matrix is invertible if and only if <m>-\omega^2</m> is not an eigenvalue of <m>A</m>. That is true if and only if <m>\omega</m> is not a natural frequency of the system.
			</p>

			<p>
				We simplified things a little bit. If we wish to have the forcing term to be in the units of force, say Newtons, then we must write 
<me>
M \vec{x}'' = K \vec{x} + \vec{G} \cos(\omega t) .
</me>
 If we then write things in terms of <m>A = M^{-1} K</m>, we have 
<me>
\vec{x}'' = M^{-1}K \vec{x} + M^{-1} \vec{G} \cos(\omega t) 
\qquad \text{or} \qquad
\vec{x}'' = A \vec{x} + \vec{F} \cos(\omega t) ,
</me>
 where <m>\vec{F} = M^{-1} \vec{G}</m>.
			</p>


<example>
<title> </title>
<statement>			<p>
				Let us take the example in with the same parameters as before: <m>m_1 = 2</m>, <m>m_2 = 1</m>, <m>k_1 = 4</m>, and <m>k_2 = 2</m>. Now suppose that there is a force <m>2 \cos (3t)</m> acting on the second cart.
			</p>
</statement>

<solution>			<p>
				The equation is 
<me>
\begin{bmatrix}
2 &amp; 0 \\
0 &amp; 1
\end{bmatrix}
{\vec{x}}'' =
\begin{bmatrix}
-4 &amp; 2 \\
2 &amp; -2
\end{bmatrix}
\vec{x} 
+ 
\begin{bmatrix}
0 \\ 2
\end{bmatrix}
\cos (3 t) \qquad \text{or} \qquad
{\vec{x}}'' =
\begin{bmatrix}
-3 &amp; 1 \\
2 &amp; -2
\end{bmatrix}
\vec{x} 
+ 
\begin{bmatrix}
0 \\ 2
\end{bmatrix}
\cos (3 t) .
</me>
 We solved the associated homogeneous equation before and found the complementary solution to be 
<me>
\vec{x}_c =
\begin{bmatrix} 1 \\ 2 \end{bmatrix}
\bigl( a_1 \cos (t) + b_1 \sin (t) \bigr)
+
\begin{bmatrix} 1 \\ -1 \end{bmatrix}
\bigl( a_2 \cos (2t) + b_2 \sin (2t) \bigr) .
</me>

			</p>

			<p>
				The natural frequencies are 1 and 2. As 3 is not a natural frequency, we try <m>\vec{c} \cos (3t)</m>. We invert <m>(A+3^2 I)</m>: 
<me>
{\left( \begin{bmatrix}
-3 &amp; 1 \\
\noalign{\smallskip}
2 &amp; -2
\end{bmatrix}
+3^2 I\right)}^{-1}
=
{\begin{bmatrix}
6 &amp; 1 \\
\noalign{\smallskip}
2 &amp; 7
\end{bmatrix}}^{-1}
=
\begin{bmatrix}
\frac{7}{40} &amp; \frac{-1}{40} \\
\noalign{\smallskip}
\frac{-1}{20} &amp; \frac{3}{20}
\end{bmatrix} .
</me>
 Hence, 
<me>
\vec{c} = 
{(A +\omega^2 I)}^{-1}
(-\vec{F} ) = 
\begin{bmatrix}
\frac{7}{40} &amp; \frac{-1}{40} \\
\noalign{\smallskip}
\frac{-1}{20} &amp; \frac{3}{20}
\end{bmatrix}
\begin{bmatrix}
0 \\
\noalign{\smallskip}
-2
\end{bmatrix}
=
\begin{bmatrix}
\frac{1}{20} \\
\noalign{\smallskip}
\frac{-3}{10}
\end{bmatrix} .
</me>

			</p>

			<p>
				Combining with the general solution of the associated homogeneous problem, we get that the general solution to <m>{\vec{x}}'' = A \vec{x} + \vec{F} \cos (\omega t)</m> is 
<me>
\vec{x} = \vec{x}_c + \vec{x}_p =
\begin{bmatrix} 1 \\
\noalign{\smallskip}
2 \end{bmatrix}
\bigl( a_1 \cos (t) + b_1 \sin (t) \bigr)
+
\begin{bmatrix} 1 \\
\noalign{\smallskip}
-1 \end{bmatrix}
\bigl( a_2 \cos (2t) + b_2 \sin (2t) \bigr)
+
\begin{bmatrix}
\frac{1}{20} \\
\noalign{\smallskip}
\frac{-3}{10}
\end{bmatrix}
\cos (3t) .
</me>
 We then solve for the constants <m>a_1</m>, <m>a_2</m>, <m>b_1</m>, and <m>b_2</m> using any initial conditions we are given.
			</p>
</solution>
</example>
			<p>
				Note that given force <m>\vec{f}</m>, we write the equation as <m>M {\vec{x}}'' = K \vec{x} + \vec{f}</m> to get the units right. Then we write <m>{\vec{x}}'' = M^{-1}K \vec{x} + M^{-1}\vec{f}</m>. The term <m>\vec{g} = M^{-1} \vec{f}</m> in <m>{\vec{x}}'' = A \vec{x} + \vec{g}</m> is in units of force per unit mass.
			</p>

			<p>
				If <m>\omega</m> is a natural frequency of the system, <em></em> may occur, because we will have to try a particular solution of the form 
<me>
\vec{x}_p =
\vec{c} \, t \sin (\omega t) +
\vec{d} \, \cos (\omega t) .
</me>
 That is assuming that the eigenvalues of the coefficient matrix are distinct. Next, note that the amplitude of this solution grows without bound as <m>t</m> grows.
			</p>

		</subsection>

		<subsection xml:id="non-homogeneous-solutions">
			<title>Non-Homogeneous Solutions</title>


			<subsubsection xml:id="undetermined-coefficients-secondsys">
				<title>Undetermined coefficients</title>

				<p>
					Let the equation be 
<me>
{\vec{x}}'' = A \vec{x} + \vec{F}(t) ,
</me>
 where <m>A</m> is a constant matrix. If <m>\vec{F}(t)</m> is of the form <m>\vec{F}_0 \cos (\omega t)</m>, then as two derivatives of cosine is again cosine we can try a solution of the form 
<me>
\vec{x}_p = \vec{c} \cos (\omega t) ,
</me>
 and we do not need to introduce sines.
				</p>

				<p>
					If the <m>\vec{F}</m> is a sum of cosines, note that we still have the superposition principle. If <m>\vec{F}(t) =
\vec{F}_0 \cos (\omega_0 t) + 
\vec{F}_1 \cos (\omega_1 t)</m>, then we would try <m>\vec{a} \cos (\omega_0 t)</m> for the problem <m>{\vec{x}}'' = A \vec{x} + \vec{F}_0 \cos (\omega_0 t)</m>, and we would try <m>\vec{b} \cos (\omega_1 t)</m> for the problem <m>{\vec{x}}'' = A \vec{x} + \vec{F}_1 \cos (\omega_1 t)</m>. Then we sum the solutions.
				</p>

				<p>
					However, if there is duplication with the complementary solution, or the equation is of the form <m>{\vec{x}}'' = A{\vec{x}}'+ B \vec{x} + \vec{F}(t)</m>, then we need to do the same thing as we do for first order systems.
				</p>

				<p>
					You will never go wrong with putting in more terms than needed into your guess. You will find that the extra coefficients will turn out to be zero. But it is useful to save some time and effort.
				</p>

			</subsubsection>

			<subsubsection xml:id="eigenvector-decomposition">
				<title>Eigenvector decomposition</title>

				<p>
					If we have the system 
<me>
{\vec{x}}'' = A \vec{x} + \vec{f}(t) ,
</me>
 we can do <em></em>, just like for first order systems.
				</p>

				<p>
					Let <m>\lambda_1, \lambda_2, \ldots, \lambda_n</m> be the eigenvalues and <m>\vec{v}_1, \vec{v}_2, \ldots, \vec{v}_n</m> be eigenvectors. Again form the matrix <m>E = [\, \vec{v}_1 \quad \vec{v}_2 \quad \cdots \quad \vec{v}_n \,]</m>. Write 
<me>
\vec{x}(t) =
\vec{v}_1 \, \xi_1(t) + 
\vec{v}_2 \, \xi_2(t) + \cdots +
\vec{v}_n \, \xi_n(t) .
</me>
 Decompose <m>\vec{f}</m> in terms of the eigenvectors 
<me>
\vec{f}(t) =
\vec{v}_1 \, g_1(t) + 
\vec{v}_2 \, g_2(t) + \cdots +
\vec{v}_n \, g_n(t) ,
</me>
 where, again, <m>\vec{g} = E^{-1} \vec{f}</m>.
				</p>

				<p>
					We plug in, and as before we obtain 
<me>
\begin{split}
%{\vec{x}}'' &amp; =
\overbrace{
\vec{v}_1 \xi_1'' + 
\vec{v}_2 \xi_2'' + \cdots +
\vec{v}_n \xi_n''
}^{{\vec{x}}''}
%\\
&amp; =
\overbrace{
A \left( \vec{v}_1 \xi_1 + 
\vec{v}_2 \xi_2 + \cdots +
\vec{v}_n \xi_n \right)
}^{A\vec{x}}
+
\overbrace{
\vec{v}_1 g_1 + 
\vec{v}_2 g_2 + \cdots +
\vec{v}_n g_n
}^{\vec{f}}
\\
&amp; = 
A \vec{v}_1 \xi_1 + 
A \vec{v}_2 \xi_2 + \cdots +
A \vec{v}_n \xi_n
+
\vec{v}_1 g_1 + 
\vec{v}_2 g_2 + \cdots +
\vec{v}_n g_n
\\
&amp; =
\vec{v}_1 \lambda_1 \xi_1 + 
\vec{v}_2 \lambda_2 \xi_2 + \cdots +
\vec{v}_n \lambda_n \xi_n
+
\vec{v}_1 \, g_1 + 
\vec{v}_2 \, g_2 + \cdots +
\vec{v}_n \, g_n
\\
&amp; =
\vec{v}_1 ( \lambda_1 \xi_1 + g_1 ) +
\vec{v}_2 ( \lambda_2 \xi_2 + g_2 ) + \cdots + 
\vec{v}_n ( \lambda_n \xi_n + g_n ) .
\end{split}
</me>
 We identify the coefficients of the eigenvectors to get the equations <me>\begin{align*}
\xi_1'' &amp; = \lambda_1 \xi_1 + g_1 , \\
\xi_2'' &amp; = \lambda_2 \xi_2 + g_2 , \\
&amp; ~~ \vdots \\
\xi_n'' &amp; = \lambda_n \xi_n + g_n .
\end{align*}</me> Each one of these equations is independent of the others. We solve each equation using the methods of . We write <m>\vec{x}(t) =
\vec{v}_1 \xi_1(t) +
\vec{v}_2 \xi_2(t) + \cdots +
\vec{v}_n \xi_n(t)</m>, and we are done; we have a particular solution. We find the general solutions for <m>\xi_1</m> through <m>\xi_n</m>, and again <m>\vec{x}(t) =
\vec{v}_1 \xi_1(t) + \vec{v}_2 \, \xi_2(t) + \cdots +
\vec{v}_n \xi_n(t)</m> is the general solution (and not just a particular solution).
				</p>


<example>
<title> </title>
<statement>				<p>
					Let us do the same example from before using this method.
				</p>
</statement>

<solution>				<p>
					The equation is 
<me>
{\vec{x}}'' =
\begin{bmatrix}
-3 &amp; 1 \\
2 &amp; -2
\end{bmatrix}
\vec{x} 
+ 
\begin{bmatrix}
0 \\ 2
\end{bmatrix}
\cos (3 t) .
</me>
 The eigenvalues are <m>-1</m> and <m>-4</m>, with eigenvectors <m>\left[ \begin{smallmatrix} 1 \\ 2 \end{smallmatrix} \right]</m> and <m>\left[ \begin{smallmatrix} 1 \\ -1 \end{smallmatrix} \right]</m>. Therefore <m>E =
\left[ \begin{smallmatrix} 1 &amp; 1 \\ 2 &amp; -1 \end{smallmatrix} \right]</m> and <m>E^{-1} =
\frac{1}{3}
\left[ \begin{smallmatrix} 1 &amp; 1 \\ 2 &amp; -1 \end{smallmatrix}
\right]</m>. Therefore, 
<me>
\begin{bmatrix}
g_1 \\
\noalign{\smallskip}
g_2
\end{bmatrix}
=
E^{-1} \vec{f}(t)
=
\frac{1}{3}
\begin{bmatrix} 1 &amp; 1 \\
\noalign{\smallskip}
2 &amp; -1 \end{bmatrix}
\begin{bmatrix} 0 \\
\noalign{\smallskip}
2\cos (3t) \end{bmatrix}
=
\begin{bmatrix} \frac{2}{3}\cos (3t)
\\
\noalign{\smallskip}
\frac{-2}{3}\cos (3t) \end{bmatrix} .
</me>
 So after the whole song and dance of plugging in, the equations we get are 
<me>
\xi_1'' = - \xi_1 + \frac{2}{3} \cos (3t) , \qquad
\xi_2'' = -4 \, \xi_2 - \frac{2}{3} \cos (3t) .
</me>
 For each equation we use the method of undetermined coefficients. We try <m>C_1 \cos (3t)</m> for the first equation and <m>C_2 \cos (3t)</m> for the second equation. We plug in to get <me>\begin{align*}
- 9 C_1 \cos (3t) &amp; = - C_1 \cos (3t) + \frac{2}{3} \cos (3t) , \\
- 9 C_2 \cos (3t) &amp; = - 4 C_2 \cos (3t) - \frac{2}{3} \cos (3t) .
\end{align*}</me> We solve each of these equations separately. We get <m>- 9 C_1 = - C_1 + \nicefrac{2}{3}</m> and <m>- 9 C_2 = - 4C_2 - \nicefrac{2}{3}</m>. And hence <m>C_1 = \nicefrac{-1}{12}</m> and <m>C_2 = \nicefrac{2}{15}</m>. So our particular solution is 
<me>
\vec{x} =
\begin{bmatrix} 1 \\
2 \end{bmatrix} \,
\left( \frac{-1}{12} \, \cos (3t) \right)
+
\begin{bmatrix} 1 \\
-1 \end{bmatrix} \,
\left( \frac{2}{15} \, \cos (3t) \right)
=
\begin{bmatrix} \nicefrac{1}{20} \\
\nicefrac{-3}{10} \end{bmatrix} \,
\cos (3t) .
</me>
 This solution matches what we got previously.
				</p>
</solution>
</example>
			</subsubsection>
		</subsection>

<exercises>
			<title>Exercises</title>

<exercise>
<statement>
			<p>
				Find a particular solution to 
<me>
{\vec{x}}'' =
\begin{bmatrix}
-3 &amp; 1 \\
2 &amp; -2
\end{bmatrix}
\vec{x} 
+ 
\begin{bmatrix}
0 \\ 2
\end{bmatrix}
\cos (2 t) .
</me>

			</p>
</statement>

<answer>			<p>
				 <m>\vec{x}(t) = \left[\begin{smallmatrix} 1 \\ -1 \end{smallmatrix}\right]\left(C_1\cos(2t) + C_2\sin(2t)\right) + \left[\begin{smallmatrix} 1 \\ 2 \end{smallmatrix}\right](C_3\cos(t) + C_4\sin(t)) + \left[\begin{smallmatrix} -1/6 \\ 1/6 \end{smallmatrix}\right]t\sin(2t) + \left[\begin{smallmatrix} -2/9 \\ -4/9 \end{smallmatrix}\right]\cos(2t)</m> 
			</p>
</answer>
</exercise>

<exercise>
<statement>
			<p>
				Find the general solution to <m>\left[ \begin{smallmatrix}
1 &amp; 0 &amp; 0\\
0 &amp; 2 &amp; 0\\
0 &amp; 0 &amp; 3
\end{smallmatrix}\right]
\vec{x}\,''
=
\left[ \begin{smallmatrix}
-3 &amp; 0 &amp; 0 \\
2 &amp; -4 &amp; 0 \\
0 &amp; 6 &amp; -3
\end{smallmatrix}\right]
\vec{x}
+ 
\left[ \begin{smallmatrix}
\cos(2t) \\ 0 \\ 0
\end{smallmatrix}\right]</m>.
			</p>
</statement>

</exercise>
<exercise>
<statement>
			<p>
				Let us take the example in with the same parameters as before: <m>m_1 = 2</m>, <m>k_1 = 4</m>, and <m>k_2 = 2</m>, except for <m>m_2</m>, which is unknown. Suppose that there is a force <m>\cos (5 t)</m> acting on the first mass. Find an <m>m_2</m> such that there exists a particular solution where the first mass does not move.
			</p>

			<p>
				Note: This idea is called <em></em>. In practice there will be a small amount of damping and so any transient solution will disappear and after long enough time, the first mass will always come to a stop.
			</p>
</statement>

<answer>			<p>
				 <m>m= 2/25</m> 
			</p>
</answer>
</exercise>

<exercise>
<statement>
			<p>
				Let us take the , but that at time of impact, car 2 is moving to the left at the speed of .
			</p>

<!-- div attr= class="tasks"-->
			<p>
				Find the behavior of the system after linkup. Will the second car hit the wall, or will it be moving away from the wall as time goes on? At what speed would the first car have to be traveling for the system to essentially stay in place after linkup?
			</p><!--</div attr= class="tasks">-->
</statement>

<answer>			<p>
				 a)  <m>\vec{x}(t) = \left[\begin{smallmatrix} t + \frac{2}{\sqrt{3}}\sin(\sqrt{3}t) \\ t - \frac{4}{\sqrt{3}}\sin(\sqrt{3}t) \end{smallmatrix}\right]</m> b) It will hit the wall. c) <m>v_2 = 1.5</m> m/s to the right 
			</p>
</answer>
</exercise>

<exercise>
<statement>
			<p>
				Let us take the example in with parameters <m>m_1 = m_2 = 1</m>, <m>k_1 = k_2 = 1</m>. Does there exist a set of initial conditions for which the first cart moves but the second cart does not? If so, find those conditions. If not, argue why not.
			</p>
</statement>

<answer>			<p>
				 No 
			</p>
</answer>
</exercise>

<exercise>
<statement>
			<p>
				Suppose there are three carts of equal mass <m>m</m> and connected by two springs of constant <m>k</m> (and no connections to walls). Set up the system and find its general solution.
			</p>
</statement>

</exercise>
<exercise>
<statement>
			<p>
				Suppose a cart of mass kg is attached by a spring of constant <m>k=1</m> to a cart of mass kg, which is attached to the wall by a spring also of constant <m>k=1</m>. Suppose that the initial position of the first cart is 1 meter in the positive direction from the rest position, and the second mass starts at the rest position. The masses are not moving and are let go. Find the position of the second mass as a function of time.
			</p>
</statement>

</exercise>
<exercise>
<statement>
			<p>
				Find the general solution to <m>x_1'' = -6x_1+ 3x_2 + \cos (t)</m>, <m>x_2'' = 2x_1 -7x_2 + 3\cos (t)</m>,
			</p>

<!-- div attr= class="tasks"-->
			<p>
				(2) using eigenvector decomposition, using undetermined coefficients.
			</p><!--</div attr= class="tasks">-->
</statement>

<answer>			<p>
				 <m>\vec{x}(t) = \left[\begin{smallmatrix} 1 \\ -1 \end{smallmatrix}\right](C_1\cos(3t) + C_2\sin(3t)) + \left[\begin{smallmatrix} 3 \\ 2 \end{smallmatrix}\right](C_3\cos(2t) + C_4\sin(2t)) + \left[\begin{smallmatrix} 8/13 \\ 17/26 \end{smallmatrix}\right]\cos(t)</m> 
			</p>
</answer>
</exercise>

<exercise>
<statement>
			<p>
				Find the general solution to <m>x_1'' = -6x_1+ 3x_2 + \cos (2t)</m>, <m>x_2'' = 2x_1 -7x_2 + 3\cos (2t)</m>,
			</p>

<!-- div attr= class="tasks"-->
			<p>
				(2) using eigenvector decomposition, using undetermined coefficients.
			</p><!--</div attr= class="tasks">-->
</statement>

<answer>			<p>
				 <m>\vec{x}(t) = \left[\begin{smallmatrix} 1 \\ -1 \end{smallmatrix}\right](C_1\cos(3t) + C_2\sin(3t)) + \left[\begin{smallmatrix} 3 \\ 2 \end{smallmatrix}\right](C_3\cos(2t) + C_4\sin(2t)) + \left[\begin{smallmatrix} -\frac{7}{25}\cos(2t) + \frac{3}{5}t\sin(2t) \\ \frac{7}{25} + \frac{2}{5}t\sin(2t) \end{smallmatrix}\right]</m> 
			</p>
</answer>
</exercise>

<exercise>
<statement>
			<p>
				Solve <m>x_1'' = -3x_1 + x_2 + t</m>, <m>x_2'' = 9x_1 + 5x_2
+\cos(t)</m> with initial conditions <m>x_1(0) = 0</m>, <m>x_2(0) = 0</m>, <m>x_1'(0) = 0</m>, <m>x_2'(0) = 0</m>, using eigenvector decomposition.
			</p>
</statement>
</exercise></exercises>

	</section>



